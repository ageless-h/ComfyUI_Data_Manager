{"version":3,"file":"ssh.js","sources":["../frontend/src/api/ssh.ts"],"sourcesContent":["/**\n * ComfyUI Data Manager - SSH API\n */\n\nexport interface SSHConnectOptions {\n  host: string\n  port: number\n  username: string\n  password: string\n}\n\nexport interface SSHConnectResponse {\n  success?: boolean\n  connection_id: string\n  host?: string\n  port?: number\n  username?: string\n  root_path?: string\n  message?: string\n  error?: string\n}\n\nexport interface SSHListResponse {\n  files: unknown[]\n  path: string\n  connection_id: string\n}\n\n/**\n * SSH 凭证接口\n */\nexport interface SSHCredential {\n  id: string\n  name: string\n  host: string\n  port: number\n  username: string\n  password?: string\n  created?: string | null\n}\n\n/**\n * 保存凭证响应\n */\nexport interface SSHSaveCredentialResponse {\n  success: boolean\n  credential?: SSHCredential\n  error?: string\n}\n\n/**\n * 列出凭证响应\n */\nexport interface SSHListCredentialsResponse {\n  success: boolean\n  credentials: SSHCredential[]\n  count: number\n  error?: string\n}\n\n/**\n * 删除凭证响应\n */\nexport interface SSHDeleteCredentialResponse {\n  success: boolean\n  error?: string\n}\n\n/**\n * Connect to SSH host\n * @param host - Host address\n * @param port - Port number\n * @param username - Username\n * @param password - Password\n * @returns Connection result\n */\nexport async function sshConnect(\n  host: string,\n  port: number,\n  username: string,\n  password: string\n): Promise<SSHConnectResponse> {\n  const response = await fetch('/dm/ssh/connect', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      host,\n      port: port || 22,\n      username,\n      password,\n    }),\n  })\n\n  if (!response.ok) {\n    const error = (await response.json().catch(() => ({ error: '连接失败' }))) as SSHConnectResponse\n    throw new Error(error.error || error.message || 'SSH 连接失败')\n  }\n\n  return (await response.json()) as SSHConnectResponse\n}\n\n/**\n * Disconnect SSH connection\n * @param connectionId - Connection ID\n * @returns Disconnect result\n */\nexport async function sshDisconnect(\n  connectionId: string\n): Promise<{ success: boolean; message?: string; error?: string }> {\n  const response = await fetch('/dm/ssh/disconnect', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ connection_id: connectionId }),\n  })\n\n  if (!response.ok) {\n    const error = (await response.json().catch(() => ({ error: '断开失败' }))) as Record<\n      string,\n      unknown\n    >\n    throw new Error((error.error as string) || (error.message as string) || 'SSH 断开失败')\n  }\n\n  return await response.json()\n}\n\n/**\n * List remote directory contents\n * @param connectionId - Connection ID\n * @param path - Remote path\n * @returns Directory contents\n */\nexport async function sshList(connectionId: string, path = '.'): Promise<SSHListResponse> {\n  const response = await fetch('/dm/ssh/list', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      connection_id: connectionId,\n      path,\n    }),\n  })\n\n  if (!response.ok) {\n    const error = (await response.json().catch(() => ({ error: '列出目录失败' }))) as Record<\n      string,\n      unknown\n    >\n    throw new Error((error.error as string) || (error.message as string) || 'SSH 列出目录失败')\n  }\n\n  return (await response.json()) as SSHListResponse\n}\n\n/**\n * 保存 SSH 连接凭证到服务器\n * @param credential - 凭证信息\n * @returns 保存结果\n */\nexport async function sshSaveCredential(\n  credential: SSHCredential\n): Promise<SSHSaveCredentialResponse> {\n  const response = await fetch('/dm/ssh/credentials/save', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(credential),\n  })\n\n  if (!response.ok) {\n    const error = (await response.json().catch(() => ({ error: '保存凭证失败' }))) as SSHSaveCredentialResponse\n    throw new Error(error.error || '保存 SSH 凭证失败')\n  }\n\n  return (await response.json()) as SSHSaveCredentialResponse\n}\n\n/**\n * 获取已保存的 SSH 凭证列表\n * @returns 凭证列表\n */\nexport async function sshListCredentials(): Promise<SSHListCredentialsResponse> {\n  const response = await fetch('/dm/ssh/credentials/list', {\n    method: 'GET',\n    headers: { 'Content-Type': 'application/json' },\n  })\n\n  if (!response.ok) {\n    const error = (await response.json().catch(() => ({ error: '获取凭证列表失败' }))) as SSHListCredentialsResponse\n    throw new Error(error.error || '获取 SSH 凭证列表失败')\n  }\n\n  return (await response.json()) as SSHListCredentialsResponse\n}\n\n/**\n * 删除已保存的 SSH 凭证\n * @param credentialId - 凭证 ID\n * @returns 删除结果\n */\nexport async function sshDeleteCredential(\n  credentialId: string\n): Promise<SSHDeleteCredentialResponse> {\n  const response = await fetch('/dm/ssh/credentials/delete', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ id: credentialId }),\n  })\n\n  if (!response.ok) {\n    const error = (await response.json().catch(() => ({ error: '删除凭证失败' }))) as SSHDeleteCredentialResponse\n    throw new Error(error.error || '删除 SSH 凭证失败')\n  }\n\n  return (await response.json()) as SSHDeleteCredentialResponse\n}\n"],"names":["sshConnect","host","port","username","password","response","error","sshDisconnect","connectionId","sshList","path","sshSaveCredential","credential","sshListCredentials","sshDeleteCredential","credentialId"],"mappings":"AA4EA,eAAsBA,EACpBC,EACAC,EACAC,EACAC,EAC6B,CAC7B,MAAMC,EAAW,MAAM,MAAM,kBAAmB,CAC9C,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAA,EAC3B,KAAM,KAAK,UAAU,CACnB,KAAAJ,EACA,KAAMC,GAAQ,GACd,SAAAC,EACA,SAAAC,CAAA,CACD,CAAA,CACF,EAED,GAAI,CAACC,EAAS,GAAI,CAChB,MAAMC,EAAS,MAAMD,EAAS,KAAA,EAAO,MAAM,KAAO,CAAE,MAAO,MAAA,EAAS,EACpE,MAAM,IAAI,MAAMC,EAAM,OAASA,EAAM,SAAW,UAAU,CAC5D,CAEA,OAAQ,MAAMD,EAAS,KAAA,CACzB,CAOA,eAAsBE,EACpBC,EACiE,CACjE,MAAMH,EAAW,MAAM,MAAM,qBAAsB,CACjD,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAA,EAC3B,KAAM,KAAK,UAAU,CAAE,cAAeG,EAAc,CAAA,CACrD,EAED,GAAI,CAACH,EAAS,GAAI,CAChB,MAAMC,EAAS,MAAMD,EAAS,KAAA,EAAO,MAAM,KAAO,CAAE,MAAO,MAAA,EAAS,EAIpE,MAAM,IAAI,MAAOC,EAAM,OAAqBA,EAAM,SAAsB,UAAU,CACpF,CAEA,OAAO,MAAMD,EAAS,KAAA,CACxB,CAQA,eAAsBI,EAAQD,EAAsBE,EAAO,IAA+B,CACxF,MAAML,EAAW,MAAM,MAAM,eAAgB,CAC3C,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAA,EAC3B,KAAM,KAAK,UAAU,CACnB,cAAeG,EACf,KAAAE,CAAA,CACD,CAAA,CACF,EAED,GAAI,CAACL,EAAS,GAAI,CAChB,MAAMC,EAAS,MAAMD,EAAS,KAAA,EAAO,MAAM,KAAO,CAAE,MAAO,QAAA,EAAW,EAItE,MAAM,IAAI,MAAOC,EAAM,OAAqBA,EAAM,SAAsB,YAAY,CACtF,CAEA,OAAQ,MAAMD,EAAS,KAAA,CACzB,CAOA,eAAsBM,EACpBC,EACoC,CACpC,MAAMP,EAAW,MAAM,MAAM,2BAA4B,CACvD,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAA,EAC3B,KAAM,KAAK,UAAUO,CAAU,CAAA,CAChC,EAED,GAAI,CAACP,EAAS,GAAI,CAChB,MAAMC,EAAS,MAAMD,EAAS,KAAA,EAAO,MAAM,KAAO,CAAE,MAAO,QAAA,EAAW,EACtE,MAAM,IAAI,MAAMC,EAAM,OAAS,aAAa,CAC9C,CAEA,OAAQ,MAAMD,EAAS,KAAA,CACzB,CAMA,eAAsBQ,GAA0D,CAC9E,MAAMR,EAAW,MAAM,MAAM,2BAA4B,CACvD,OAAQ,MACR,QAAS,CAAE,eAAgB,kBAAA,CAAmB,CAC/C,EAED,GAAI,CAACA,EAAS,GAAI,CAChB,MAAMC,EAAS,MAAMD,EAAS,KAAA,EAAO,MAAM,KAAO,CAAE,MAAO,UAAA,EAAa,EACxE,MAAM,IAAI,MAAMC,EAAM,OAAS,eAAe,CAChD,CAEA,OAAQ,MAAMD,EAAS,KAAA,CACzB,CAOA,eAAsBS,EACpBC,EACsC,CACtC,MAAMV,EAAW,MAAM,MAAM,6BAA8B,CACzD,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAA,EAC3B,KAAM,KAAK,UAAU,CAAE,GAAIU,EAAc,CAAA,CAC1C,EAED,GAAI,CAACV,EAAS,GAAI,CAChB,MAAMC,EAAS,MAAMD,EAAS,KAAA,EAAO,MAAM,KAAO,CAAE,MAAO,QAAA,EAAW,EACtE,MAAM,IAAI,MAAMC,EAAM,OAAS,aAAa,CAC9C,CAEA,OAAQ,MAAMD,EAAS,KAAA,CACzB"}